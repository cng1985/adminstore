
<!-- 增加页面开始 -->

[#macro adAddView]
    <div  class="model-form">
        <el-page-header @back="goBack" content="增加广告">
        </el-page-header>
        <div class="model-content">
            <el-form ref="ruleForm" :rules="rules" :model="form" label-width="160px" >
                <el-row :gutter="10">
 <el-col :span="22">
     <el-form-item label="广告名称" size="mini" prop="title">
             <el-input v-model="form.title" name="title">
             </el-input>
     </el-form-item>
      
 </el-col>
 <el-col :span="22">
     <el-form-item label="广告位" size="mini" prop="adPosition">
             <el-select style="width: 100%;"  v-model="form.adPosition" filterable clearable
                     placeholder="请选择">
                 <el-option v-for="item in adPositionOptions" :key="item.id"
                         :label="item.name" :value="item.id">
                 </el-option>
             </el-select>
     </el-form-item>
      
 </el-col>
 <el-col :span="22">
     <el-form-item label="广告图片" size="mini" prop="path">
         <avatar  v-model="form.path"  ></avatar>
     </el-form-item>
      
 </el-col>
 <el-col :span="22">
     <el-form-item label="广告开始时间" size="mini" prop="beginDate">
         <el-date-picker v-model="form.beginDate" type="datetime" value-format="yyyy-MM-dd HH:mm" placeholder="选择日期">
         </el-date-picker>
     </el-form-item>
      
 </el-col>
 <el-col :span="22">
     <el-form-item label="广告结束时间" size="mini" prop="endDate">
         <el-date-picker v-model="form.endDate" type="datetime" value-format="yyyy-MM-dd HH:mm" placeholder="选择日期">
         </el-date-picker>
     </el-form-item>
      
 </el-col>
 <el-col :span="22">
     <el-form-item label="链接地址" size="mini" prop="url">
             <el-input v-model="form.url" name="url">
             </el-input>
     </el-form-item>
      
 </el-col>
 <el-col :span="22">
     <el-form-item label="内容" size="mini" prop="note">
             <el-input v-model="form.note" name="note" type="textarea"></el-input>
     </el-form-item>
      
 </el-col>
                </el-row>
               <el-row>
                    <el-col :span="24"  style="text-align: right;padding-bottom: 20px;padding-top: 20px;">
                        <el-button @click="goBack">取消</el-button>
                        <el-button type="primary" @click="add">确定</el-button>
                    </el-col>
			    </el-row>
            </el-form>
        </div>
    </div>
[/#macro]

[#macro adAddConfig]
<script type="text/x-template" id="my-ad-add">
	[@adAddView /]
</script>
<script type="text/javascript">
		//添加组件开始
		var adAddConfig = {};
		adAddConfig.template = "#my-ad-add";
		adAddConfig.methods = config.basicMethod();
		adAddConfig.data = function () {
			return {
				form: {
					title: '',
					adPosition: '',
					path: '',
					beginDate: '',
					endDate: '',
					url: '',
					note: ''				},
				rules: {
                        title: [
							{ required: true, message: '请输入广告名称', trigger: 'blur' }
						],
                        adPosition: [
							{ required: true, message: '请输入广告位', trigger: 'blur' }
						],
				}
			}
		};
		adAddConfig.mounted = function () {
		}
		adAddConfig.computed = {};
				  adAddConfig.computed.adPositionOptions = function () {
						return this.$store.state.adPositionOptions;
					};


		adAddConfig.methods.add = function () {
			var self = this;
			this.$refs["ruleForm"].validate(function(valid){
				if (valid) {
					self.addData();
				} else {
					console.log('error submit!!');
					return false;
				}
			});
		}

		adAddConfig.methods.addData = function () {
			var self = this, data = this.form;
			if (this.deforeAddData) {
				this.deforeAddData();
			}
			this.postData("${siteurl}tenantRest/ad/create.htm", data, function (res) {
				if (res.code == 0) {
					self.$message({
						message: '添加数据成功',
						type: 'success'
					});
					self.$router.go(-1);
				} else {
					self.$message.error(res.msg);
				}
			});
		}

        adAddConfig.destroyed = function () {
            console.log("destroyed add view ");
            
	    }
		var  adAddView = Vue.component('add-view', adAddConfig);


</script>
[/#macro]

<!-- 增加页面结束 -->