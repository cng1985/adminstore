<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>个人信息</title>
    [#include "/admin/common/commons.html"]
    [#include "/tenant/common/site.html"]
    [#include "/tenant/admin/system/componentProfileShow.html"]
    [#include "/tenant/admin/system/componentProfilePassword.html"]
    [#include "/tenant/admin/system/componentProfileLog.html"]

    [@baseHead /]
    <script type="text/javascript"></script>
</head>

<body class="hold-transition skin-blue sidebar-mini">
    <!-- Site wrapper -->
    <div class="wrapper">

        <header class="main-header">
            <!-- Header Navbar: style can be found in header.less -->
            [#include "/admin/common/nav.html"]
        </header>

        <!-- =============================================== -->

        <!-- Left side column. contains the sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">
                [@user_panel /]
                <!-- search form -->
                [@sidebar_form /]
                <!-- /.search form -->
                <!-- sidebar menu: : style can be found in sidebar.less -->
                <ul class="sidebar-menu" data-widget="tree">
                    <li class="header">主面板</li>
                    [@menustag id=1]
                    [#list list as item]
                    [@menu item "1,2,43"]
                    [/@menu]
                    [/#list]
                    [/@menustag]
                </ul>
            </section>
            <!-- /.sidebar -->
        </aside>

        <!-- =============================================== -->

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper" id="app" v-cloak>
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <!-- 导航 -->
                <div class="navigation">
                    <i>首页</i> <span>个人信息</span>
                </div>
            </section>
            <!-- Main content -->
            <section class="content ">
                <el-row class="model-form">
                    <el-col :span="4">
                        <el-menu style="min-height: 500px;" :default-active="activeIndex" @select="handleSelect">
                            <el-menu-item index="1">
                                <i class="el-icon-user-solid"></i>
                                <span slot="title">基本设置</span>
                            </el-menu-item>
                            <el-menu-item index="2">
                                <i class="el-icon-s-tools"></i>
                                <span slot="title">安全设置</span>
                            </el-menu-item>
                            <el-menu-item index="3">
                                <i class="el-icon-s-management"></i>
                                <span slot="title">登录记录</span>
                            </el-menu-item>
                        </el-menu>
                    </el-col>
                    <el-col :span="20">
                        <keep-alive>
                            <router-view v-if="$route.meta.keepAlive">
                            </router-view>
                        </keep-alive>
                        <router-view v-if="!$route.meta.keepAlive">
                        </router-view>
                    </el-col>
                </el-row>
                <!-- Default box -->
            </section>


            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->

        [#include "/admin/common/footer.html"]

        <!-- Control Sidebar -->
        [#include "/admin/common/aside.html"]

        <!-- /.control-sidebar -->
        <!-- Add the sidebar's background. This div must be placed
     immediately after the control sidebar -->
        <div class="control-sidebar-bg"></div>
    </div>
    <!-- ./wrapper -->
    [@baseScript /]
    [#include "/tenant/default/common/component.html" /]
    [@nbSelect /]
    [@avatar /]

    <script type="text/javascript">
        var config = {};

        config.methods = {};

        [@configBasicVue /]

        config.methods.goBack = function () {
            this.$router.go(-1);
        }
        config.basicMethod = function () {
            var result = {};
            result.postData = config.methods.postData;
            result.postJsonData = config.methods.postJsonData;
            result.goBack = config.methods.goBack;
            return result;
        }

        config.methods.loadProductCatalogOptions = function () {
            var self = this;
            var param = {};
            param.sortMethod = "asc";
            param.sortField = "id";
            param.level = 1;
            param.size = 500;
            param.fetch = 1;
            $.post("${siteurl}tenantRest/productcatalog/list.htm", param, function (result) {
                if (result.code == 0) {
                    self.$store.commit('updateProductCatalogOptions', result.list);
                }
            });
        }


    </script>



    [@profileShowConfig /]
    [@passwordShowConfig /]
    [@logShowConfig /]

    <script type="text/javascript">

        // 3. 创建 router 实例，然后传 `routes` 配置
        // 你还可以传别的配置参数, 不过先这么简单着吧。
        var appConfig = {};
        appConfig.el = "#app";


        const routes = [
            { path: '/password', component: passwordShowView, props: true },
            { path: '/log', component: logShowView, props: true },
            {
                path: '/', name: "profileShowView", component: profileShowView, props: true, meta: {
                    keepAlive: true, //此组件不需要被缓存
                }
            }
        ]



        const router = new VueRouter({
            routes: routes // (缩写) 相当于 routes: routes
        })

        var store = new Vuex.Store({
            state: {
                count: 0,
                productCatalogOptions: [],
            },
            mutations: {
                increment: function (state) {
                    state.count++
                },
                updateProductCatalogOptions: function (state, obj) {
                    state.productCatalogOptions = obj;
                },

            }
        })

        appConfig.router = router;
        appConfig.data = function () {
            return {
                viewModel: {
                },
                activeIndex: "1"
            }
        };
        appConfig.store = store;
        appConfig.methods = config.methods;
        appConfig.mounted = function () {
            var activeIndex = this.$route.query.activeIndex;
            if (activeIndex) {
                this.activeIndex = activeIndex;
                console.info(activeIndex)
            }
        }
        appConfig.methods.handleSelect = function (event) {
            this.selectIndex = event;
            if (event == "1") {
                this.$router.replace({ path: '/', query: { activeIndex: 1, time: Math.random() } })
            }
            else if (event == "2") {
                this.$router.replace({ path: '/password', query: { activeIndex: 2, time: Math.random() } })
            } else if (event == "3") {
                this.$router.replace({ path: '/log', query: { activeIndex: 3, time: Math.random() } })
            } else {

            }
        }
        var vm = new Vue(appConfig);

    </script>

</body>

</html>